<template>
    <div class="bg-[#B4C0D0] rounded-[0px_40px_40px_40px] pb-[112px] l2:px-[16px]">
        <div class="flex flex-col gap-[24px] items-center pt-[80px]">
            <p
                class="max-w-[1103px] l2:hidden font-sans text-[96px] font-normal leading-[96px] tracking-[-0.06em] text-center text-[#1F2933]">
                Video Interview Session</p>
            <p
                class="max-w-[380px] hidden l2:block font-sans text-[96px] font-normal leading-[96px] tracking-[-0.06em] text-center text-[#1F2933]">
                Interview Session</p>
            <p
                class="max-w-[899px] l2:max-w-[383px] font-sans text-[24px] font-normal leading-[28.8px] tracking-[-0.02em] text-center text-[#1F2933A3]">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua.</p>
        </div>
        <div class="flex flex-col gap-[24px] items-center pt-[60px]">
            <p
                class="max-w-[1103px] font-sans text-[64px] font-normal leading-[64px] tracking-[-0.04em] text-center text-[#1F2933]">
                Question 2 of 4</p>
            <p
                class="max-w-[1140px] l2:max-w-[780px] font-sans text-[32px] font-medium leading-[38.4px] tracking-[-0.02em] text-center text-[#1F2933]">
                Can you describe a challenging situation you faced in your role and how you handled it?</p>
        </div>
        <div class="flex gap-[117px] l2:gap-[40px] mt-[40px] items-center justify-center l2:flex-col-reverse">
            <div class="flex flex-col l2:max-w-[464px] l2:w-[100%]">
                <div class="flex flex-col gap-[10px]">
                    <div
                        class="flex gap-[16px] py-[16px] px-[32px] bg-[white] rounded-[40px] border border-[#1F293314] l2:p-[32px_24px]">
                        <div
                            class="flex flex-col items-center justify-center gap-[5px] p-[8px_16px] rounded-[27px] border border-[#1F293314] bg-[#BAD8F14D] h-[100%]">
                            <p class="text-[#1F2933] font-sans text-[20px] font-medium leading-[24px] text-left">01</p>
                            <img src="../../assets/images/completed.png" alt="completed">
                        </div>
                        <p
                            class="max-w-[426px] l2:max-w-[238px] font-sans text-[20px] font-medium leading-[24px] text-left text-[#1F2933]">
                            How do you prioritize tasks when managing multiple projects at once?</p>
                    </div>
                    <div
                        class="flex gap-[16px] py-[16px] px-[32px] bg-[white] rounded-[40px] border border-[#398B39] l2:p-[32px_24px] l2:bg-[#E4ECF7] l2:border-[#1F293314]">
                        <div
                            class="flex flex-col items-center justify-center gap-[5px] p-[8px_16px] rounded-[27px] border border-[#1F293314] bg-[#BAD8F14D] h-[100%]">
                            <p class="text-[#1F2933] font-sans text-[20px] font-medium leading-[24px] text-left">02</p>
                        </div>
                        <p
                            class="max-w-[426px] l2:max-w-[238px] font-sans text-[20px] font-medium leading-[24px] text-left text-[#1F2933]">
                            Can you describe a challenging situation you faced in your role and how you handled it?</p>
                    </div>
                    <div
                        class="flex gap-[16px] py-[16px] px-[32px] bg-[white] rounded-[40px] border border-[#1F293314] l2:p-[32px_24px]">
                        <div
                            class="flex flex-col items-center justify-center gap-[5px] p-[8px_16px] rounded-[27px] border border-[#1F293314] bg-[#BAD8F14D] h-[100%]">
                            <p class="text-[#1F2933] font-sans text-[20px] font-medium leading-[24px] text-left">03</p>
                        </div>
                        <p
                            class="max-w-[426px] l2:max-w-[238px] font-sans text-[20px] font-medium leading-[24px] text-left text-[#1F2933]">
                            What strategies do you use to stay updated on industry trends and advancements?</p>
                    </div>
                    <div
                        class="flex flex-col gap-[24px] py-[16px] px-[32px] bg-[white] rounded-[40px] border border-[#1F293314] l2:p-[32px_24px]">
                        <div class="flex gap-[16px]">
                            <div
                                class="flex flex-col items-center justify-center gap-[5px] p-[8px_16px] rounded-[27px] border border-[#1F293314] bg-[#BAD8F14D] h-[100%]">
                                <p class="text-[#1F2933] font-sans text-[20px] font-medium leading-[24px] text-left">03
                                </p>
                            </div>
                            <p
                                class="max-w-[426px] l2:max-w-[238px] font-sans text-[20px] font-medium leading-[24px] text-left text-[#1F2933]">
                                What strategies do you use to stay updated on industry trends and advancements?</p>
                        </div>
                        <div class="flex gap-[4px] l2:flex-wrap l2:w-[100%] l2:max-w-[68%]">
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">1</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">2</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">3</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">4</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">5</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">6</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">7</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">8</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">9</span>
                            <span
                                class="border border-[#E9ECEF] w-[32px] h-[32px] rounded-[8px] flex items-center justify-center text-[#1F2933] font-sans text-[18px] font-normal leading-[24px] tracking-[-0.02em] text-center cursor-pointer">10</span>
                        </div>
                    </div>
                </div>
                <div class="mt-[40px] l2:hidden">
                    <div class="flex gap-[16px]">
                        <button
                            class="w-[271.5px] h-[56px] flex items-center justify-center border border-[#1F2933] p-[20px_32px] gap-[10px] rounded-[40px] text-[#1F2933] font-sans text-[16px] font-medium leading-[16px] text-left">Previous</button>
                        <button
                            class="w-[271.5px] h-[56px] flex items-center justify-center border border-[#1F2933] p-[20px_32px] gap-[10px] rounded-[40px] bg-[#1F2933] text-[white] font-sans text-[16px] font-medium leading-[16px] text-left">Next</button>
                    </div>
                </div>
                <div class="mt-[80px] l2:mt-[48px]">
                    <div class="flex flex-col gap-[16px] l2:flex-row">
                        <button
                            class="font-sans text-[16px] font-medium leading-[16px] text-left text-[#1F2933] w-[559px] h-[56px] p-[20px_32px] gap-[10px] rounded-[40px] border border-[#1F2933] flex items-center l2:max-w-[220px] l2:w-[100%] justify-center">Add
                            Question</button>
                        <button
                            class="font-sans text-[16px] font-medium leading-[16px] text-left text-[#1F2933] w-[559px] h-[56px] p-[20px_32px] gap-[10px] rounded-[40px] border border-[#1F2933] flex items-center l2:max-w-[220px] l2:w-[100%] justify-center">Submit</button>
                    </div>
                </div>
            </div>
            <div class="flex items-center flex-col gap-[24px]">
                <div
                    class="bg-[url('../../../src/assets/images/videiRecordReview.png')] rounded-[40px] w-[464px] h-[642px] small:w-[350px] small:bg-center">
                    <div class="flex flex-col h-[100%] justify-between">
                        <div class="flex items-center justify-end pr-[24px] pt-[24px]">
                            <div @click="openSettingsPopup"
                                class="bg-[#1F293314] w-[56px] h-[56px] top-[24px] left-[384px] p-[16px] gap-[10px] rounded-[40px] border border-[#1F293314] flex items-center justify-center cursor-pointer">
                                <img src="../../assets/images/settingVideo.png" alt="setting">
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-center">
                                <div v-if="!isRecording"
                                    class="w-[80px] h-[80px] rounded-[40px] bg-[white] flex items-center justify-center cursor-pointer"
                                    @click="toggleRecording">
                                    <img src="../../assets/images/recorderVideoIcon.png" alt="record">
                                </div>
                                <div v-if="isRecording && !isStopped"
                                    class="w-[80px] h-[80px] rounded-[40px] bg-[white] flex items-center justify-center cursor-pointer"
                                    @click="toggleStop">
                                    <div
                                        class="w-[14px] h-[14px] flex items-center justify-center rounded-[4px] transform rotate-180 bg-[#1F2933A3]">
                                    </div>
                                </div>
                                <div v-if="isStopped"
                                    class="w-[80px] h-[80px] rounded-[40px] bg-[white] flex items-center justify-center cursor-pointer"
                                    @click="resumeRecording">
                                    <img src="../../assets/images/play.png" alt="stopped" class="filter-play-png">
                                </div>
                            </div>
                            <div v-if="!isRecording" class="w-[100%] h-[67px] custom-gradient"></div>
                            <div v-else
                                class="w-[100%] h-[67px] custom-gradient flex items-center gap-[10px] pl-[24px]">
                                <p v-if="!isStopped"
                                    class="text-[#FFFFFF] font-sans text-[16px] font-medium leading-[20.83px] flex text-left">
                                    REC</p>
                                <span
                                    class="text-[#FFFFFF] font-sans text-[16px] font-medium leading-[20.83px] flex text-left">{{
                                        formattedTime }}</span>
                                <img v-if="isStopped" src="../../assets/images/record-video.png" alt="record"
                                    class="cursor-pointer">
                                <img v-if="isStopped" src="../../assets/images/Delete.png" alt="Delete"
                                    @click="openDeletePopup" class="cursor-pointer ml-[54px]">
                            </div>
                        </div>
                    </div>
                </div>
                <div v-if="isStopped" class="l2:hidden">
                    <button
                        class="w-[462px] p-[16px_32px] flex items-center justify-center gap-[10px] rounded-[40px] bg-[#DAFF98] text-[#398B39] font-dm-sans text-base font-medium leading-5 text-left">
                        <img src="../../assets/images/edit-pencel.png" alt="edit">
                        Edit Video
                    </button>
                </div>
                <div class="hidden l2:block l2:w-[100%]">
                    <button
                        class="w-[100%] p-[16px_32px] flex items-center justify-center gap-[10px] rounded-[40px] bg-[#DAFF98] text-[#398B39] font-dm-sans text-base font-medium leading-5 text-left">
                        <img src="../../assets/images/edit-pencel.png" alt="edit">
                        Edit Video
                    </button>
                </div>
                <div class="hidden l2:block w-full">
                    <div class="flex gap-[16px] items-center justify-between">
                        <button
                            class="l2:max-w-[220px] l2:w-[100%] flex items-center justify-center border border-[#1F2933] p-[20px_32px] gap-[10px] rounded-[40px] text-[#1F2933] font-sans text-[16px] font-medium leading-[16px] text-left">Previous</button>
                        <button
                            class="l2:max-w-[220px] l2:w-[100%] flex items-center justify-center border border-[#1F2933] p-[20px_32px] gap-[10px] rounded-[40px] bg-[#1F2933] text-[white] font-sans text-[16px] font-medium leading-[16px] text-left">Next</button>
                    </div>
                </div>
            </div>
        </div>
        <div v-if="showDeletePopup"
            class="flex-col fixed inset-0 flex items-center justify-center bg-[#1F293314] backdrop-blur-24 l2:px-[30px]">
            <div class="l2:w-[100%] l2:max-w-[495px]">
                <div class="l2:flex l2:justify-between">
                    <img src="../../assets/images/delete-record-popup-img.png" alt="" class="w-[72%]">
                    <div class="w-[56px] l2:flex hidden l2:bg-[#1F2933] h-[56px] p-4 gap-[10px] rounded-[40px] border-2 border-[#1F293314] items-center justify-center cursor-pointer"
                        @click="closeDeletePopup">
                        <img src="../../assets/images/close.png" alt="close" style="filter: brightness(0) saturate(100%) invert(79%) sepia(100%) saturate(2%) hue-rotate(201deg) brightness(107%) contrast(101%);">
                    </div>
                </div>
                <div>
                    <div class="relative bg-white px-[48px] py-[48px] rounded-[0px_40px_40px_40px]">
                        <div class="absolute top-[-10px]"><img src="../../assets/images/delete-record-popup-icon.png"
                                alt=""></div>
                        <div class="flex items-center justify-end l2:hidden">
                            <div class="w-[56px] h-[56px] p-4 gap-[10px] rounded-[40px] border-2 border-[#1F293314] flex items-center justify-center cursor-pointer"
                                @click="closeDeletePopup">
                                <img src="../../assets/images/close.png" alt="close">
                            </div>
                        </div>
                        <div class="max-w-[753px]">
                            <p
                                class="text-[#1F2933] font-dm-sans text-[64px] font-normal leading-[64px] tracking-[-0.04em] text-left l2:mt-[40px]">
                                Are you sure you want to delete this video?</p>
                        </div>
                        <div class="flex items-center gap-[24px] mt-[40px]">
                            <button
                                class="w-[130px] h-[56px] p-[20px] gap-[10px] rounded-[40px] bg-[#1F2933] font-dm-sans text-base font-medium leading-4 text-left text-[white] flex items-center justify-center"
                                @click="deleteVideo">Yes</button>
                            <button
                                class="w-[130px] h-[56px] p-[20px] gap-[10px] rounded-[40px] bg-[white] border border-[#1F2933] font-dm-sans text-base font-medium leading-4 text-left text-[#1F2933] flex items-center justify-center"
                                @click="closeDeletePopup">No</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="showSettingsPopup"
            class="flex-col fixed inset-0 flex items-center justify-center bg-[#1F293314] backdrop-blur-24 l2:px-[30px]">
            <div class="l2:w-[100%] l2:max-w-[495px]">
                <div class="l2:flex l2:justify-between">
                    <img src="../../assets/images/delete-record-popup-img.png" alt="" class="w-[72%]">
                    <div class="w-[56px] l2:flex hidden l2:bg-[#1F2933] h-[56px] p-4 gap-[10px] rounded-[40px] border-2 border-[#1F293314] items-center justify-center cursor-pointer"
                        @click="closeSettingsPopup">
                        <img src="../../assets/images/close.png" alt="close" style="filter: brightness(0) saturate(100%) invert(79%) sepia(100%) saturate(2%) hue-rotate(201deg) brightness(107%) contrast(101%);">
                    </div>
                </div>
                <div>
                    <div class="relative bg-white px-[48px] pb-[156px] pt-[48px] rounded-[0px_40px_40px_40px] l2:pb-[32px] l2:px-[14px]">
                        <div class="absolute top-[-10px]"><img src="../../assets/images/setting-popup-icon.png" alt="">
                        </div>
                        <div class="flex items-center justify-end l2:hidden">
                            <div class="w-[56px] h-[56px] p-4 gap-[10px] rounded-[40px] border-2 border-[#1F293314] flex items-center justify-center cursor-pointer"
                                @click="closeSettingsPopup">
                                <img src="../../assets/images/close.png" alt="close">
                            </div>
                        </div>
                        <div class="max-w-[753px] l2:mt-[30px]">
                            <p
                                class="text-[#1F2933] text-[64px] font-normal leading-[64px] tracking-[0.04em] text-left">
                                Settings</p>
                        </div>
                        <div class="flex items-start gap-[64px] mt-[32px] l2:flex-col l2:gap-[32px]">
                            <div
                                class="gap-[10px] rounded-[40px] font-dm-sans text-base font-medium leading-4 text-left text-[white] flex flex-col items-center justify-center l2:w-[100%]">
                                <button @click="toggleActiveButton('audio')"
                                    class="w-[222px] l2:w-full h-[46px] p-[10px] gap-[10px] rounded-[20px] flex items-center"
                                    :class="activeButton === 'audio' ? 'bg-[#DAFF98] text-[#398B39]' : 'bg-[#ffffff] text-[#1F2933]'">
                                    <img v-if="activeButton === 'audio'"
                                        src="../../assets/images/microphone-recorder.png" alt="">
                                    <img v-else src="../../assets/images/inactive-microphone.png" alt="">
                                    Audio
                                </button>
                                <button @click="toggleActiveButton('video')"
                                    class="w-[222px] l2:w-full h-[46px] p-[10px] gap-[10px] rounded-[20px] flex items-center"
                                    :class="activeButton === 'video' ? 'bg-[#DAFF98] text-[#398B39]' : 'bg-[#ffffff] text-[#1F2933]'">
                                    <img v-if="activeButton !== 'video'" src="../../assets/images/video-recorder.svg"
                                        alt="">
                                    <img v-else src="../../assets/images/active-video.png" alt="">
                                    Video
                                </button>
                            </div>
                            <div class="flex flex-col gap-[24px] l2:w-[100%]">
                                <div v-if="activeButton !== 'video'" class="flex flex-col gap-[8px]">
                                    <p
                                        class="text-[#1F2933] font-dm-sans text-[14px] font-semibold leading-[20px] text-left">
                                        Microphone</p>
                                    <div
                                        class="border border-[#1F293314] p-[16px] gap-[25px] rounded-[24px] flex items-center l2:justify-between">
                                        <div class="flex items-center gap-[8px]">
                                            <img src="../../assets/images/microphone-01.png" class="w-[20px] h-[20px]"
                                                alt="">
                                            <p
                                                class="text-[#1F2933] w-[257px] font-dm-sans text-[16px] font-normal leading-[20px] text-left">
                                                MacBook Pro Microphone (Buit-in)</p>
                                        </div>
                                        <div>
                                            <img src="../../assets/images/arrow-down-icon.png" alt="">
                                        </div>
                                    </div>
                                </div>
                                <div v-if="activeButton !== 'video'" class="flex flex-col gap-[8px]">
                                    <p
                                        class="text-[#1F2933] font-dm-sans text-[14px] font-semibold leading-[20px] text-left">
                                        Speaker</p>
                                    <div
                                        class="border border-[#1F293314] p-[16px] gap-[25px] rounded-[24px] flex items-center l2:justify-between">
                                        <div class="flex items-center gap-[8px]">
                                            <img src="../../assets/images/speaker-recorder.svg" alt="">
                                            <p
                                                class="text-[#1F2933] font-dm-sans text-[16px] w-[257px] font-normal leading-[20px] text-left">
                                                MacBook Pro Ызуфлукы (Buit-in)</p>
                                        </div>
                                        <div>
                                            <img src="../../assets/images/arrow-down-icon.png" alt="">
                                        </div>
                                    </div>
                                </div>
                                <div v-else class="flex flex-col gap-[8px]">
                                    <p
                                        class="text-[#1F2933] font-dm-sans text-[14px] font-semibold leading-[20px] text-left">
                                        Camera</p>
                                    <div
                                        class="border border-[#1F293314] p-[16px] gap-[25px] rounded-[24px] flex items-center l2:justify-between">
                                        <div class="flex items-center gap-[8px]">
                                            <img src="../../assets/images/video-select-icon.svg" alt="">
                                            <p
                                                class="text-[#1F2933] font-dm-sans text-[16px] w-[257px] font-normal leading-[20px] text-left">
                                                FaceTime HD Camera</p>
                                        </div>
                                        <div>
                                            <img src="../../assets/images/arrow-down-icon.png" alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref, onUnmounted, computed } from 'vue';

const isRecording = ref(false);
const isStopped = ref(false);
const showDeletePopup = ref(false);
const showSettingsPopup = ref(false);
const secondsOfVideo = ref(0);
const activeButton = ref('audio');
let timer = null;

const toggleRecording = () => {
    isRecording.value = true;
    isStopped.value = false;
    secondsOfVideo.value = 0;
    startTimer();
};

const toggleStop = () => {
    isStopped.value = true;
    stopTimer();
};

const resumeRecording = () => {
    if (isStopped.value) {
        isRecording.value = true;
        isStopped.value = false;
        startTimer();
    }
};

const startTimer = () => {
    timer = setInterval(() => {
        secondsOfVideo.value++;
    }, 1000);
};

const stopTimer = () => {
    clearInterval(timer);
};

const openDeletePopup = () => {
    showDeletePopup.value = true;
    document.body.style.overflow = 'hidden';
};

const closeDeletePopup = () => {
    showDeletePopup.value = false;
    document.body.style.overflow = '';
};

const openSettingsPopup = () => {
    showSettingsPopup.value = true;
    document.body.style.overflow = 'hidden';
};

const closeSettingsPopup = () => {
    showSettingsPopup.value = false;
    document.body.style.overflow = '';
};

const deleteVideo = () => {
    isRecording.value = false
    isStopped.value = false
    showDeletePopup.value = false
    closeDeletePopup();
};

const toggleActiveButton = (buttonType) => {
    activeButton.value = buttonType;
};

onUnmounted(() => {
    stopTimer();
    document.body.style.overflow = '';
});

const formattedTime = computed(() => {
    const hours = Math.floor(secondsOfVideo.value / 3600);
    const minutes = Math.floor((secondsOfVideo.value % 3600) / 60);
    const seconds = secondsOfVideo.value % 60;

    return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
});

</script>

<style scoped>
.custom-gradient {
    background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.8) 100%);
    border-radius: 0px 0px 40px 40px;
}

.filter-play-png {
    filter: brightness(0) saturate(100%) invert(44%) sepia(18%) saturate(1501%) hue-rotate(72deg) brightness(98%) contrast(90%)
}
</style>